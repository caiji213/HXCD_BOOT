Modbus 升级通信测试报文（TX/RX）对照表
=======================================

说明：以下是基于 GD32 Bootloader + 上位机 C# 工具（UpgradeApp）的完整 Modbus 报文交互过程，包含每一阶段发送与接收帧。可用于串口助手调试、自动化测试脚本开发。

-------------------------------------------------------------------------------------------------------------------------------------------------
序号 | 操作说明                          | 上位机发送（TX）                                                                | 单片机应答（RX）
-------------------------------------------------------------------------------------------------------------------------------------------------
①    | 读取硬件 ID                     | 01 43 00 1D 00 00 00 00 1F 01                                           | 01 43 00 1D 00 00 00 21 DF 19
②    | 跳转 Bootloader            | 01 43 4F 47 00 00 00 00 49 33                                           | 01 43 4F 47 00 00 00 00 49 33
③    | 发送升级信息                  | 01 41 11 00 00 00 21 00 06 29 F8 C5 15 93 73 A8 8E    | 01 41 11 00 00 00 21 00 06 29 F8 C5 15 93 73 A8 8E
④    | 擦除 Flash                       | 01 43 00 F0 00 00 00 00 B3 16                                           | 01 43 00 F0 00 00 00 00 B3 16
⑤    | 烧录 Flash 数据块           | 01 42 00 00 00 00 0F F4 [数据...] CRC                                | 01 42 00 06 1B 68 0E 90 E8 F7
⑥    | 校验升级结果                  | 01 43 80 C0 00 00 00 00 EC D2                                          | 01 43 80 C0 00 00 00 00 EC D2
⑦    | 跳转到 App                    | 01 43 47 4F 00 00 00 00 A9 BA                                          | 01 43 47 4F 00 00 00 00 A9 BA

备注说明：
- 所有 CRC 校验为标准 Modbus CRC16（低位在前，小端）
- 地址 0x01，功能码 0x41/0x42/0x43 为扩展自定义操作
- 第⑤步数据块长度通常为 4084 字节（0x0FF4），实际数据略

串口调试建议：
- 模式：HEX 发送
- 波特率：115200，8-N-1
- 串口助手工具推荐：SSCOM / XCOM / ModbusPoll / Python串口库



下面是 Modbus 升级通信测试报文中每一对 发送（TX）与应答（RX）帧的详细讲解，包括字段含义、功能码作用、回复数据含义和成功判断方法。

  报文逐帧解释

 ① 读取硬件 ID

  TX：01 43 00 1D 00 00 00 00 1F 01
| 字节               | 含义                                              |
| ---------------| ----------------------------------- |
| 01                  | 从站地址（设备地址）                |
| 43                  | 功能码：自定义（通用操作）     |
| 00 1D            | 操作码：读取硬件ID (0x001D)   |
| 00 00 00 00 | 操作参数：无                                |
| 1F 01            | CRC16（小端）校验                    |

 RX：01 43 00 1D 00 00 00 21 DF 19
| 字节               | 含义                                         |
| -------------- | -------------------------------- |
| 01                  | 设备地址                                  |
| 43                  | 功能码                                      |
| 00 1D            | 操作码确认                              |
| 00 00 00 21 | 返回硬件 ID（此处为 0x21） |
| DF 19            | CRC16                                     |
表示硬件ID读取成功，值为 0x21

 ② 跳转 Bootloader
 TX：01 43 4F 47 00 00 00 00 49 33
| 字节          | 含义                                                        |
| ----------   | ----------------------------------------- |
| 4F 47        | 操作码：跳转 Bootloader (0x4F47)  |
| 后4字节    | 参数无                                                    |

 RX：01 43 4F 47 00 00 00 00 49 33
回显确认跳转，说明设备已成功进入 Bootloader 模式

 ③ 发送升级信息
 TX：01 41 11 00 00 00 21 00 06 29 F8 C5 15 93 73 A8 8E

| 字节               | 含义                                       |
| -------------   | ------------------------------ |
| 01                  | 设备地址                               |
| 41                  | 功能码：发送升级信息        |
| 11                  | 升级信息标识/子功能码       |
| 00 00 00 21 | 硬件 ID（与上面匹配）        |
| 00 06 29 F8 | App 大小（400120 字节） |
| C5 15 93 73 | App 文件 CRC32                 |
| A8 8E            | CRC 校验                              |

 RX：
01 41 11 00 00 00 21 00 06 29 F8 C5 15 93 73 A8 8E
 数据完全一致，表示 Bootloader 成功接收到升级信息

 ④ 擦除 Flash
TX：01 43 00 F0 00 00 00 00 B3 16

| 字节        | 含义                                        |
| ---------- | ------------------------------  |
| 00 F0      | 操作码：擦除 App 区 Flash |
| 后4字节  | 参数为 0                                 |

 RX：01 43 00 F0 00 00 00 00 B3 16
 设备确认擦除完成

 ⑤ 烧录 Flash 数据块（示例）
TX（头部）：01 42 00 00 00 00 0F F4 [4084 字节数据] CRC

| 字节                   | 含义                       |
| ----------------  | -------------------- |
| 42                     | 功能码：写入 Flash |
| 00 00 00 00     | 地址：起始地址      |
| 0F F4                 | 长度：4084 字节   |
| [数据]                | 固件块                     |
| CRC_L CRC_H | CRC 校验                 |

 RX：01 42 00 06 1B 68 0E 90 E8 F7

回传地址 + 长度确认，写入成功

⑥ 校验升级结果

TX：01 43 80 C0 00 00 00 00 EC D2

| 字节         | 含义                                    |
| ---------- | ----------------------------- |
| 80 C0       | 操作码：校验 App 内容   |
| 后4字节    | 参数无（或默认0）           |

RX：01 43 80 C0 00 00 00 00 EC D2
 回显原始请求，表示 CRC 校验成功（结果为 0）

 ⑦ 跳转到 App

  TX：01 43 47 4F 00 00 00 00 A9 BA
| 字节      | 含义                         |
| ------- | ----------------------- |
| 47 4F | 操作码：跳转到 App |

 RX：01 43 47 4F 00 00 00 00 A9 BA
 成功跳转到 App 区


 总结判断要点

| 阶段                      | 判定条件                                                  |
| ------------------- | ------------------------------------------- |
| 读取硬件ID           | 回复中包含预期 ID                                  |
| 跳转 Bootloader | 收到回显响应                                          |
| 升级信息               | 回显升级包中的 HwID/Len/CRC 一致  |
| 擦除 Flash             | 回复成功且 CRC 校验一致                     |
| 烧写数据块            | 回传地址 + 长度                                     |
| 校验成功                | 校验结果返回 0                                      |
| 跳转 App               | 收到回显确认                                         |


